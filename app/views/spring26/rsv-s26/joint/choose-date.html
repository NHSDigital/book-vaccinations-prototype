<!-- Use this page as the index for your project -->

<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the layout from /views/layout.html -->
{% extends 'layout-rsv.html' %}
<!-- 
  In /views/layout.html you can:
    - change the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title -->
{% block pageTitle %}
Book vaccinations prototype
{% endblock %}

<!-- For adding a breadcrumb -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs -->
{% block beforeContent %}
<a class="nhsuk-back-link" href="javascript:history.back()">Back</a>
{% endblock %}

<!-- For adding a back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/back-link -->
{% block outerContent %}
{% endblock %}

<!-- For adding page content -->
<!-- Page layout code can be found at https://service-manual.nhs.uk/design-system/styles/layout -->
{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">

      <!-- Change the page title here -->

      <!-- Add your content here -->
      <!-- Styles and components can be found at https://service-manual.nhs.uk/design-system -->


      <form action="choose-time-range" method="get" class="form">

        <fieldset class="nhsuk-fieldset">
          <legend class="nhsuk-fieldset__legend nhsuk-fieldset__legend--l">
            <h1 class="nhsuk-fieldset__heading">
            Choose a date
              </h1>
          </legend>
          <p>{{data['pharmacy']}}</p>

                            <div id="coadmin-inset" class="nhsuk-inset-text" style="display: none;">
  <span class="nhsuk-u-visually-hidden">Information: </span>
  <p>
    {{ data['first-name'] | default('John') }} {{ data['last-name'] | default('Doe') }}:
    <span id="vaccine-display-1"></span><br>
    {{ data['first-name2'] | default('Jane') }} {{ data['last-name2'] | default('Doe') }}:
    <span id="vaccine-display-2"></span><br>
  </p>
  <p>
    If you can't find a vaccination site near you, you can
    <a href="#" id="change-to-single">look for RSV only appointments</a>.
  </p>
</div>



          <p class="nhsuk-body-l">Next 10 available days</p>
        <div class="nhsuk-form-group">
          <div class="nhsuk-radios" data-module="nhsuk-radios" data-nhsuk-radios-init="">
      
            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Wednesday, 1 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days">
                Friday 28 November
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning and afternoon available
              </div>
            </div>
      
            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Thursday, 2 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Saturday 29 November
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Friday, 3 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Sunday 30 November
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Afternoon available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Monday, 6 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Monday 1 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Afternoon available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Tuesday, 7 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Tuesday 2 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Afternoon available
              </div>
            </div>

                        <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Wednesday, 8 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days">
                Wednesday 3 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning and afternoon available
              </div>
            </div>
      
            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Thursday, 9 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Thursday 4 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Friday, 10 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Friday 5 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Monday, 13 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Saturday 6 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning available
              </div>
            </div>

            <div class="nhsuk-radios__item">
              <input class="nhsuk-radios__input" id="appt-days-radio" name="date" type="radio" value="Tuesday, 14 October">
              <label class="nhsuk-label nhsuk-radios__label" for="appt-days-radio">
                Sunday 7 December
              </label>
              <div class="nhsuk-hint nhsuk-radios__hint" id="example-hints-1-item-hint">
                Morning available
              </div>
            </div>


          </div>
          </div>        
        
        </fieldset>

        <nav class="nhsuk-pagination" role="navigation" aria-label="Pagination">
            <ul class="nhsuk-list nhsuk-pagination__list">
              <li class="nhsuk-pagination-item--previous" style="text-align: left; float: left;">
                <a class="nhsuk-pagination__link nhsuk-pagination__link--previous" href="choose-date2">
                  <span class="nhsuk-pagination__title">Show later dates</span>
                  <span class="nhsuk-u-visually-hidden">:</span>
                  <span class="nhsuk-pagination__page">Next 10 available days</span>
                  <svg class="nhsuk-icon nhsuk-icon__arrow-right" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" width="34" height="34">
                    <path d="M19.6 11.66l-2.73-3A.51.51 0 0 0 16 9v2H5a1 1 0 0 0 0 2h11v2a.5.5 0 0 0 .32.46.39.39 0 0 0 .18 0 .52.52 0 0 0 .37-.16l2.73-3a.5.5 0 0 0 0-.64z"></path>
                  </svg>
                </a>
              </li>
            </ul>
          </nav>
        <button class="nhsuk-button" data-module="nhsuk-button" type="submit">
          Continue and choose time range
        </button>
    </form>

    <a class="nhsuk-button nhsuk-button--secondary" href="choose-pharmacy">
        Choose a different site
      </a>

      
      </div>
      <!-- End of content -->

    </div>
  </div>

  <script>
document.addEventListener("DOMContentLoaded", function () {
  function initVaccineChoice(options = {}) {
    const insetId = options.insetId || "coadmin-inset";
    const linkId = options.linkId || "change-to-single";
    const displayIds = options.displayIds || ["vaccine-display-1", "vaccine-display-2"];

    const inset = document.getElementById(insetId);
    const changeLink = document.getElementById(linkId);
    const displaySpans = displayIds.map(id => document.getElementById(id));

    // Retrieve stored vaccine values for both people
    let vaccineChoices = [
      localStorage.getItem("vaccineChoice1"),
      localStorage.getItem("vaccineChoice2")
    ];

    // Default any missing or blank values to "single"
    vaccineChoices = vaccineChoices.map(choice =>
      !choice || choice.trim() === "" ? "RSV" : choice
    );

    // Store defaults if needed
    localStorage.setItem("vaccineChoice1", vaccineChoices[0]);
    localStorage.setItem("vaccineChoice2", vaccineChoices[1]);

    // Determine if inset should be visible (if either includes co-admin)
    const showInset = vaccineChoices.some(choice => choice.includes("COVID-19"));
    if (inset) inset.style.display = showInset ? "block" : "none";

    // Update displayed vaccine choices
    displaySpans.forEach((span, i) => {
      if (span) span.textContent = vaccineChoices[i];
    });

    // Handle link click â†’ switch both to single only
    if (inset && changeLink) {
      changeLink.addEventListener("click", function (e) {
        e.preventDefault();
        vaccineChoices = ["RSV", "RSV"];
        localStorage.setItem("vaccineChoice1", vaccineChoices[0]);
        localStorage.setItem("vaccineChoice2", vaccineChoices[1]);
        inset.style.display = "none";

        displaySpans.forEach((span, i) => {
          if (span) span.textContent = vaccineChoices[i];
        });
      });
    }
  }

  // Initialize with default IDs
  initVaccineChoice();
});
</script>

{% endblock %}
