<!-- Use this page as the index for your project -->

<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the layout from /views/layout.html -->
{% extends 'layout-covid.html' %}
<!-- 
  In /views/layout.html you can:
    - change the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title -->
{% block pageTitle %}
Book vaccinations prototype
{% endblock %}

<!-- For adding a breadcrumb -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs -->
{% block beforeContent %}
{{ backLink({
  href: "javascript:history.back()",
  text: "Back"
}) }}
{% endblock %}

<!-- For adding a back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/back-link -->
{% block outerContent %}
{% endblock %}

<!-- For adding page content -->
<!-- Page layout code can be found at https://service-manual.nhs.uk/design-system/styles/layout -->
{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">

      <!-- Change the page title here -->

      <!-- Add your content here -->
      <!-- Styles and components can be found at https://service-manual.nhs.uk/design-system -->


      <form class="form">

        <div class="nhsuk-form-group">
            <fieldset class="nhsuk-fieldset" aria-describedby="example-hint" role="group">
              <legend class="nhsuk-fieldset__legend nhsuk-label--l">
                <h1 class="nhsuk-fieldset__heading">
                  What is your postcode?
                </h1>
              </legend>
              <div class="nhsuk-hint" id="example-hint">
                Enter the postcode that is currently registered with your GP surgery.
              </div>
          
              <label class="nhsuk-label" for="postcode">
                Postcode
              </label>
              <input class="nhsuk-input nhsuk-input--width-10" id="postcode" name="postcode" type="text">            

            </fieldset>
          
          </div>

        <button id="continue-button" class="nhsuk-button" type="button">Continue</button>    
      </form>
    
      </div>
      <!-- End of content -->

    </div>
  </div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const continueButton = document.getElementById("continue-button");

  if (!continueButton) {
    console.error("Continue button not found");
    return;
  }

  continueButton.addEventListener("click", function () {

    const age = parseInt(localStorage.getItem("age1"), 10);

    if (isNaN(age)) {
      alert("Age information missing. Please go back and re-enter your date of birth.");
      return;
    }

    // Route based on age
    if (age >= 75 && age <= 120) {
      window.location.href = "add-person";
    } else {
      window.location.href = "self-referral";
    }
  });
});
</script>

{% endblock %}
