<!-- Use this page as the index for your project -->

<!-- ADDING CUSTOM CSS - Add your custom CSS or Sass in /app/assets/sass/main.scss -->

<!-- Extends the layout from /views/layout.html -->
{% extends 'layout.html' %}
<!-- 
  In /views/layout.html you can:
    - change the header and footer 
    - add custom CSS and JavaScript
-->

<!-- Set the page title -->
{% block pageTitle %}
  Manage appointments
{% endblock %}

<!-- For adding a breadcrumb -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/breadcrumbs -->
{% block beforeContent %}
{% endblock %}

<!-- For adding a back link -->
<!-- Code examples can be found at https://service-manual.nhs.uk/design-system/components/back-link -->
{% block outerContent %}
{% endblock %}

<!-- For adding page content -->
<!-- Page layout code can be found at https://service-manual.nhs.uk/design-system/styles/layout -->
{% block content %}
<script>

  // (1) show item 2
  
    function showitem2() {
    var x = document.getElementById("item-2");
    if (x.style.display === "none") {
      x.style.display = "block";
    } else {
      x.style.display = "block";
    }
  }
  
  //  (2) hide item 2
  
  function hideitem2() {
  var x = document.getElementById("item-2");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "none";
  }
  }
  
  // (3) hide add another on item 1
  
  function hideadd1() {
    var x = document.getElementById("add-2");
    if (x.style.display === "block") {
      x.style.display = "none";
    } else {
      x.style.display = "none";
    }
    }
  
  // (4) show add another on item 1
    function showadd1() {
      var x = document.getElementById("add-2");
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "block";
      }
      }
  
  // (5) show item 3
  function showitem3() {
  var x = document.getElementById("item-3");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "block";
  }
  }
  
  // (6) hide item 3
  function hideitem3() {
  var x = document.getElementById("item-3");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "none";
  }
  }
  
  // (7) hide add another on item 2
  
  function hideadd2() {
    var x = document.getElementById("add-3");
    if (x.style.display === "block") {
      x.style.display = "none";
    } else {
      x.style.display = "none";
    }
    }
  
  // (8) show add another on item 2
    function showadd2() {
      var x = document.getElementById("add-3");
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "block";
      }
      }

  // (9) show item 4
  function showitem4() {
  var x = document.getElementById("item-4");
  if (x.style.display === "none") {
    x.style.display = "block";
  } else {
    x.style.display = "block";
  }
  }
  
  // (10) hide item 4
  function hideitem4() {
  var x = document.getElementById("item-4");
  if (x.style.display === "block") {
    x.style.display = "none";
  } else {
    x.style.display = "none";
  }
  }

    // (7) hide add another on item 3
  
    function hideadd3() {
    var x = document.getElementById("add-4");
    if (x.style.display === "block") {
      x.style.display = "none";
    } else {
      x.style.display = "none";
    }
    }

  // (8) show add another on item 3
  function showadd3() {
      var x = document.getElementById("add-4");
      if (x.style.display === "none") {
        x.style.display = "block";
      } else {
        x.style.display = "block";
      }
      }
  
  </script>

  <style>

.items {
  display: none;
}

.list-item-wrapper-vertical {
padding-left: 20px;
padding-right: 20px;
}

.list-item-wrapper-vertical input {
width: 80%;
}

.list-item-wrapper-vertical .remove-list-item-vertical {
margin-top: 4.4em;
display: block;
}

.list-item-wrapper-vertical .heading-medium {
margin-top: 0;
}

.button-add-another-vertical {
background-color: #eee;
color: #000;
box-shadow: 0 2px 0 #666;
}

.button-add-another-vertical:hover {
background-color: #ccc;
color: #000;
box-shadow: 0 2px 0 #666;
}

.button-add-another-vertical:focus {
background-color: #ccc;
color: #000;
box-shadow: 0 2px 0 #666;
}

@media (max-width: 640px) {
.list-item-wrapper-vertical inpit {
width: 100%;
}

.button-add-another-vertical {
width: 90%;
margin: auto;
display: block;
}
}

</style>

  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">

      <div class="nhsuk-back-link">

        <a class="nhsuk-back-link__link" href="javascript:history.back()">
          <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
            <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
          </svg>
          Go back</a>
      </div>
            <!-- Change the page title here -->
            <span class="nhsuk-caption-l">Create single date session</span>
            <h1 class="nhsuk-heading-l">Set time and capacity for your session</h1>

      <form action="single-services" class="form">

                <!-- session times -->
                
                
                        <legend class="nhsuk-heading-s">Session times </legend>
                
                        <div class="nhsuk-hint" id="contact-hint">
                            For example, 14:30
                          </div>
                          <div class="nhsuk-grid-column-one-quarter" style="padding: 0;">
                            <label class="nhsuk-label" for="startTime">Start time</label>
                            <input class="nhsuk-input  nhsuk-input--width-2" label="Start time" id="start-time" name="start-time"> : <input class="nhsuk-input  nhsuk-input--width-2" label="Start time" id="start-time" name="start-time">
                          </div><br><br><br><br>
                          <div class="nhsuk-grid-column-one-half" style="padding: 0;">
                            <label class="nhsuk-label">End time</label>
                            <input class="nhsuk-input  nhsuk-input--width-2" label="End time" id="end-time" name="end-time"> : <input class="nhsuk-input  nhsuk-input--width-2" label="End time" id="end-time" name="end-time">
                            </div>
                                
     

        <br><br><br><div class="nhsuk-form-group"><br><br>
          


        <h5 class="nhsuk-heading-m" style="margin-bottom: 8px;">Capacity</h5>
        <div class="nhsuk-hint" id="contact-hint">
          Enter your capacity to calculate appointment numbers for this session.
        </div>
        <h5 class="nhsuk-heading-s" style="margin-bottom: 8px;">How many vaccinators or vaccination spaces do you have?</h5>
                <fieldset class="nhsuk-fieldset" aria-describedby="contact-hint">
        <div class="nhsuk-form-group">
          <input class="nhsuk-input nhsuk-input--width-3" id="simultaneous-appointments" name="simultaneous-appointments" type="text">
        </div>

        <h5 class="nhsuk-heading-s" style="margin-bottom: 8px;">How long are your appointments?</h5>
        <div class="nhsuk-hint" id="contact-hint">
          Appointment length must be a maximum of 60 minutes or less.
        </div>
        <div class="nhsuk-form-group">
          <input class="nhsuk-input nhsuk-input--width-3" id="appointment-length" name="appointment-length" type="text"><div class="nhsuk-input__suffix" aria-hidden="true">Minutes</div>
        </div>
        </fieldset>

      </div>
      <div class="nhsuk-inset-text">
        <strong><p style="margin-bottom: 0px;">Capacity calculator</p></strong>
        <span class="nhsuk-u-visually-hidden">Information: </span><p><strong><span id="appointment-result"></span></strong> total appointments in the session<br>
          Up to <strong><span id="appointments-per-hour"></span></strong> appointments per hour<br>

        </p></div>

        <button class="nhsuk-button" data-module="nhsuk-button" type="submit">
          Continue
        </button>
      </form>
      

      <!-- End of content -->
    </div>
  </div>
<script>

document.addEventListener("DOMContentLoaded", function () {
    let inputs = document.querySelectorAll("#start-time, #end-time, #appointment-length, #simultaneous-appointments");

    inputs.forEach(input => {
        input.addEventListener("input", calculateAppointments);
    });
});

function calculateAppointments() {
    let startInputs = document.querySelectorAll("#start-time");
    let endInputs = document.querySelectorAll("#end-time");

    let startHour = startInputs[0].value;
    let startMinute = startInputs[1].value;
    let endHour = endInputs[0].value;
    let endMinute = endInputs[1].value;

    let appointmentLength = parseInt(document.getElementById("appointment-length").value, 10);
    let simultaneousAppointments = parseInt(document.getElementById("simultaneous-appointments").value, 10);

    let totalAppointmentsSpan = document.getElementById("appointment-result");
    let maxPerHourSpan = document.getElementById("appointments-per-hour");

    // Hide output if input is missing
    if (!startHour || !startMinute || !endHour || !endMinute || isNaN(appointmentLength) || isNaN(simultaneousAppointments)) {
        totalAppointmentsSpan.textContent = "";
        maxPerHourSpan.textContent = "";
        return;
    }

    // Convert time inputs to numbers
    startHour = parseInt(startHour, 10);
    startMinute = parseInt(startMinute, 10);
    endHour = parseInt(endHour, 10);
    endMinute = parseInt(endMinute, 10);

    let startTime = new Date();
    startTime.setHours(startHour, startMinute, 0, 0);

    let endTime = new Date();
    endTime.setHours(endHour, endMinute, 0, 0);

    // Hide output if end time is before start time
    if (endTime <= startTime) {
        totalAppointmentsSpan.textContent = "";
        maxPerHourSpan.textContent = "";
        return;
    }

    let sessionDuration = (endTime - startTime) / (1000 * 60);
    let appointmentsPerSlot = Math.floor(sessionDuration / appointmentLength);
    let totalAppointments = appointmentsPerSlot * simultaneousAppointments;

    // Calculate max appointments per hour
    let sessionHours = sessionDuration / 60;
    let maxAppointmentsPerHour = sessionHours > 0 ? Math.floor(totalAppointments / sessionHours) : 0;

    // Insert results into existing <span> elements
    totalAppointmentsSpan.textContent = totalAppointments;
    maxPerHourSpan.textContent = maxAppointmentsPerHour;
}
</script>
{% endblock %}
